---
Title: Exercise 02: Disable Malware Auto-start
Objective: Identify and temporarily disable a suspicious auto-starting program using Sysinternals Autoruns, a crucial step in malware analysis and system cleanup.
Estimated Time: 20-30 minutes
Tools Needed: Windows OS, Sysinternals Autoruns.
Setup Instructions: 
1. Download the Sysinternals Suite from the Microsoft website and extract it to a convenient location (e.g., `C:\Sysinternals`).
2. Ensure you have administrative privileges to run Autoruns effectively.
3. **Simulate a Suspicious Auto-start Entry (Recommended in a Lab Environment):**
    *   Create a simple batch script (e.g., `malicious_script.bat`) with harmless content, like `notepad.exe` or `echo "Malware simulation running!" > C:\malware_log.txt`.
    *   Place this script in a non-standard auto-start location, for example, by adding a registry entry under `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` or `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run` that points to your script.
    *   Ensure the script executes upon logon or boot (you might need to reboot your VM to confirm it runs).
    *   *Alternatively, if not simulating, you can choose a non-critical, legitimate third-party auto-starting application to disable temporarily for the exercise.* *Never disable critical system processes or unknown entries in a production environment.*
---

## Steps

1.  **Launch Autoruns as Administrator:**
    *   Navigate to your Sysinternals Suite directory.
    *   Right-click `autoruns.exe` and select "Run as administrator". This is essential for viewing and modifying all auto-start locations.

2.  **Scan and Review Auto-start Entries:**
    *   Autoruns will automatically scan your system and populate its display with entries from various auto-start locations. This may take a moment.
    *   Review the entries in the "Everything" tab or switch to specific tabs like "Logon", "Services", or "Scheduled Tasks" to narrow down your search.

3.  **Identify a Suspicious Entry:**
    *   Look for entries that meet one or more of the following criteria:
        *   **Unfamiliar Name/Description:** An application you don't recognize.
        *   **Unusual Image Path:** An executable running from a non-standard location (e.g., `C:\Users\<username>\AppData\Local\Temp` or directly in `C:\Windows` instead of `C:\Windows\System32`).
        *   **Missing Publisher/Description:** Entries lacking publisher or description information are often suspicious.
        *   **Unsigned Code:** If "Verify Code Signatures" is enabled (Options menu), unsigned entries are suspicious.
        *   **Flagged by VirusTotal:** (Optional) Go to `Options > Scan Options` and enable `Check VirusTotal.com`. If an entry is flagged by multiple engines, it's highly suspicious.
    *   *If you created a simulated suspicious entry, locate that entry.*

4.  **Temporarily Disable the Suspicious Entry:**
    *   Once you've identified a target entry, uncheck the box next to its name in Autoruns.
    *   Autoruns will prompt for confirmation. Confirm to disable the entry.
    *   The entry's row color may change to reflect it being disabled.

5.  **Reboot (or Log Off/On) to Verify Disablement:**
    *   Reboot your system (or log off and log back on, depending on the auto-start location of the disabled entry).
    *   After the system restarts, verify that the disabled program no longer launches automatically.
    *   You can also re-run Autoruns to confirm the entry is still unchecked.

6.  **Re-enable (Optional - for lab exercise cleanup):**
    *   To revert your change, re-launch Autoruns as administrator, find the disabled entry, and check its box to re-enable it.

## Expected Output

```
(Autoruns will display a list of all auto-starting entries. After unchecking a suspicious entry, it will no longer execute upon system boot or user logon.)

Example in Autoruns window:
(Highlighting a suspicious entry, for example, "MaliciousUpdater" running from C:\Users\User\AppData\malware\updater.exe)

[Screenshot of Autoruns with a specific entry unchecked]

(After reboot and checking system logs or task manager, the "MaliciousUpdater" should not be running.)
```
![Expected output](images/exercise-02-output.png)

## Reflection Questions

1.  What are some common legitimate auto-start locations that malware often abuses?
2.  How does Autoruns' "Verify Code Signatures" feature enhance its ability to detect suspicious entries?
3.  Why is it crucial to disable a suspicious auto-start entry *temporarily* first, rather than deleting it immediately?

## Next Steps

*   [Exercise 03: File Lock Detective](03-file-lock-detective.md)
*   Further reading: [Microsoft Docs: Autoruns](https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns)

## Hints / Troubleshooting

*   If Autoruns does not show all entries, ensure it is run with administrative privileges.
*   "File not found" entries highlighted in yellow are often leftover from uninstalled programs or malware.
*   Be careful when disabling entries. Disabling critical system components can prevent your system from booting. Always work in a lab environment for such tasks.
